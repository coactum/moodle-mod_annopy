{"version":3,"file":"annotations.min.js","sources":["../src/annotations.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Module for the annotation functions of the module.\n *\n * @module     mod_annopy/annotations\n * @copyright  2023 coactum GmbH\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport {removeAllTempHighlights, anchor, describe} from './highlighting';\n\nexport const init = (cmid, canaddannotation, myuserid, focusannotation, userid) => {\n\n    var edited = false;\n    var annotations = Array();\n\n    var newannotation = false;\n\n    // Remove col-mds from moodle form.\n    $('.annotation-form div.col-md-3').removeClass('col-md-3');\n    $('.annotation-form div.col-md-9').removeClass('col-md-9');\n    $('.annotation-form div.form-group').removeClass('form-group');\n    $('.annotation-form div.row').removeClass('row');\n\n    // Onclick listener if form is canceled.\n    $(document).on('click', '.annopy_submission #id_cancel', function(e) {\n        e.preventDefault();\n\n        removeAllTempHighlights(); // Remove other temporary highlights.\n\n        resetForms(); // Remove old form contents.\n\n        edited = false;\n    });\n\n    // Listen for return key pressed to submit annotation form.\n    $('.annopy_submission textarea').keypress(function(e) {\n        if (e.which == 13) {\n            $(this).parents(':eq(2)').submit();\n            e.preventDefault();\n        }\n    });\n\n    // If user selects text for new annotation\n    $(document).on('mouseup', '.originaltext', function() {\n\n        var selectedrange = window.getSelection().getRangeAt(0);\n\n        if (selectedrange.cloneContents().textContent !== '' && canaddannotation) {\n\n            removeAllTempHighlights(); // Remove other temporary highlights.\n\n            resetForms(); // Reset the annotation forms.\n\n            // Create new annotation.\n            newannotation = createAnnotation(this);\n\n            var submission = this.id.replace(/submission-/, '');\n\n            // RangeSelector.\n            $('.annotation-form-' + submission + ' input[name=\"startcontainer\"]').val(\n                newannotation.target[0].selector[0].startContainer);\n            $('.annotation-form-' + submission + ' input[name=\"endcontainer\"]').val(\n                newannotation.target[0].selector[0].endContainer);\n            $('.annotation-form-' + submission + ' input[name=\"startoffset\"]').val(\n                newannotation.target[0].selector[0].startOffset);\n            $('.annotation-form-' + submission + ' input[name=\"endoffset\"]').val(\n                newannotation.target[0].selector[0].endOffset);\n\n            // TextPositionSelector.\n            $('.annotation-form-' + submission + ' input[name=\"annotationstart\"]').val(\n                newannotation.target[0].selector[1].start);\n            $('.annotation-form-' + submission + ' input[name=\"annotationend\"]').val(\n                newannotation.target[0].selector[1].end);\n\n            // TextQuoteSelector.\n            $('.annotation-form-' + submission + ' input[name=\"exact\"]').val(\n                newannotation.target[0].selector[2].exact);\n            $('.annotation-form-' + submission + ' input[name=\"prefix\"]').val(\n                newannotation.target[0].selector[2].prefix);\n            $('.annotation-form-' + submission + ' input[name=\"suffix\"]').val(\n                newannotation.target[0].selector[2].suffix);\n\n            $('.annotation-form-' + submission + ' select').val(1);\n\n            // Prevent JavaScript injection (if annotated text in original submission is JavaScript code in script tags).\n            $('#annotationpreview-temp-' + submission).html(\n                newannotation.target[0].selector[2].exact.replaceAll('<', '&lt;').replaceAll('>', '&gt;'));\n\n            $('.annotationarea-' + submission + ' .annotation-form').show();\n            $('.annotation-form-' + submission + ' #id_text').focus();\n        }\n    });\n\n    // Fetch and recreate annotations.\n    $.ajax({\n        url: './annotations.php',\n        data: {'id': cmid, 'getannotations': 1, 'userid': userid},\n        success: function(response) {\n            annotations = JSON.parse(response);\n\n            recreateAnnotations();\n\n            // Highlight annotation and all annotated text if annotated text is hovered\n            $('.annotated').mouseenter(function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-box-' + id).addClass('hovered');\n                $('.annotated-' + id).css(\"background-color\", 'lightblue');\n            });\n\n            $('.annotated').mouseleave(function() {\n                var id = this.id.replace('annotated-', '');\n                $('.annotation-box-' + id).removeClass('hovered');\n                $('.annotated-' + id).css(\"background-color\", $('.annotated-' + id).css('textDecorationColor'));\n            });\n\n            // Highlight whole temp annotation if part of temp annotation is hovered\n            $(document).on('mouseover', '.annotated_temp', function() {\n                $('.annotated_temp').addClass('hovered');\n            });\n\n            $(document).on('mouseleave', '.annotated_temp', function() {\n                $('.annotated_temp').removeClass('hovered');\n            });\n\n            // Onclick listener for editing annotation.\n            $(document).on('click', '.annotated', function() {\n                var id = this.id.replace('annotated-', '');\n                editAnnotation(id);\n            });\n\n            // Onclick listener for editing annotation.\n            $(document).on('click', '.edit-annotation', function() {\n                var id = this.id.replace('edit-annotation-', '');\n                editAnnotation(id);\n            });\n\n            // Highlight annotation if hoverannotation button is hovered\n            $(document).on('mouseover', '.hoverannotation', function() {\n                var id = this.id.replace('hoverannotation-', '');\n                $('.annotated-' + id).css(\"background-color\", 'lightblue');\n            });\n\n            $(document).on('mouseleave', '.hoverannotation', function() {\n                var id = this.id.replace('hoverannotation-', '');\n                $('.annotated-' + id).css(\"background-color\", $('.annotated-' + id).css('textDecorationColor'));\n            });\n\n\n            // Focus annotation if needed.\n            if (focusannotation != 0) {\n                $('.annotated-' + focusannotation).attr('tabindex', -1);\n                $('.annotated-' + focusannotation).focus();\n            }\n\n        },\n        complete: function() {\n            $('#overlay').hide();\n        },\n        error: function() {\n            // For output: alert('Error fetching annotations');\n        }\n    });\n\n    /**\n     * Recreate annotations.\n     *\n     */\n    function recreateAnnotations() {\n\n        for (let annotation of Object.values(annotations)) {\n\n            const rangeSelectors = [[\n                {type: \"RangeSelector\", startContainer: annotation.startcontainer, startOffset: parseInt(annotation.startoffset),\n                endContainer: annotation.endcontainer, endOffset: parseInt(annotation.endoffset)},\n                {type: \"TextPositionSelector\", start: parseInt(annotation.annotationstart),\n                end: parseInt(annotation.annotationend)},\n                {type: \"TextQuoteSelector\", exact: annotation.exact, prefix: annotation.prefix, suffix: annotation.suffix}\n            ]];\n\n            const target = rangeSelectors.map(selectors => ({\n                selector: selectors,\n            }));\n\n            /** @type {AnnotationData} */\n            const newannotation = {\n                annotation: annotation,\n                target: target,\n            };\n\n            anchor(newannotation, $(\"#submission-\" + annotation.submission)[0]);\n        }\n    }\n\n    /**\n     * Edit annotation.\n     *\n     * @param {int} annotationid\n     */\n    function editAnnotation(annotationid) {\n\n        if (edited == annotationid) {\n            removeAllTempHighlights(); // Remove other temporary highlights.\n            resetForms(); // Remove old form contents.\n            edited = false;\n        } else if (canaddannotation && myuserid == annotations[annotationid].userid) {\n            removeAllTempHighlights(); // Remove other temporary highlights.\n            resetForms(); // Remove old form contents.\n\n            edited = annotationid;\n\n            var submission = annotations[annotationid].submission;\n\n            $('.annotation-box-' + annotationid).hide(); // Hide edited annotation-box.\n\n            $('.annotation-form-' + submission + ' input[name=\"startcontainer\"]').val(annotations[annotationid].startcontainer);\n            $('.annotation-form-' + submission + ' input[name=\"endcontainer\"]').val(annotations[annotationid].endcontainer);\n            $('.annotation-form-' + submission + ' input[name=\"startoffset\"]').val(annotations[annotationid].startoffset);\n            $('.annotation-form-' + submission + ' input[name=\"endoffset\"]').val(annotations[annotationid].endoffset);\n            $('.annotation-form-' + submission + ' input[name=\"annotationstart\"]').val(annotations[annotationid].annotationstart);\n            $('.annotation-form-' + submission + ' input[name=\"annotationend\"]').val(annotations[annotationid].annotationend);\n            $('.annotation-form-' + submission + ' input[name=\"exact\"]').val(annotations[annotationid].exact);\n            $('.annotation-form-' + submission + ' input[name=\"prefix\"]').val(annotations[annotationid].prefix);\n            $('.annotation-form-' + submission + ' input[name=\"suffix\"]').val(annotations[annotationid].suffix);\n\n            $('.annotation-form-' + submission + ' input[name=\"annotationid\"]').val(annotationid);\n\n            $('.annotation-form-' + submission + ' textarea[name=\"text\"]').val(annotations[annotationid].text);\n\n            $('.annotation-form-' + submission + ' select').val(annotations[annotationid].type);\n\n            // Prevent JavaScript injection (if annotated text in original submission is JavaScript code in script tags).\n            $('#annotationpreview-temp-' + submission).html(\n                annotations[annotationid].exact.replaceAll('<', '&lt;').replaceAll('>', '&gt;'));\n            $('#annotationpreview-temp-' + submission).css('border-color', '#' + annotations[annotationid].color);\n\n            $('.annotationarea-' + submission + ' .annotation-form').insertBefore('.annotation-box-' + annotationid);\n            $('.annotationarea-' + submission + ' .annotation-form').show();\n            $('.annotationarea-' + submission + ' #id_text').focus();\n        } else {\n            $('.annotation-box-' + annotationid).focus();\n        }\n    }\n\n    /**\n     * Reset all annotation forms\n     */\n    function resetForms() {\n        $('.annotation-form').hide();\n\n        $('.annotation-form input[name^=\"annotationid\"]').val(null);\n\n        $('.annotation-form input[name^=\"startcontainer\"]').val(-1);\n        $('.annotation-form input[name^=\"endcontainer\"]').val(-1);\n        $('.annotation-form input[name^=\"startoffset\"]').val(-1);\n        $('.annotation-form input[name^=\"endoffset\"]').val(-1);\n\n        $('.annotation-form textarea[name^=\"text\"]').val('');\n\n        $('.annotation-box').not('.annotation-form').show(); // To show again edited annotation.\n    }\n};\n\n/**\n * Create a new annotation that is associated with the selected region of\n * the current document.\n *\n * @param {object} root - The root element\n * @return {object} - The new annotation\n */\nfunction createAnnotation(root) {\n\n    const ranges = [window.getSelection().getRangeAt(0)];\n\n    if (ranges.collapsed) {\n        return null;\n    }\n\n    const rangeSelectors = ranges.map(range => describe(root, range));\n\n    const target = rangeSelectors.map(selectors => ({\n      selector: selectors,\n    }));\n\n    /** @type {AnnotationData} */\n    const annotation = {\n      target,\n    };\n\n    anchor(annotation, root);\n\n    return annotation;\n}"],"names":["obj","_jquery","__esModule","default","_exports","init","cmid","canaddannotation","myuserid","focusannotation","userid","edited","annotations","Array","newannotation","editAnnotation","annotationid","removeAllTempHighlights","resetForms","submission","$","hide","val","startcontainer","endcontainer","startoffset","endoffset","annotationstart","annotationend","exact","prefix","suffix","text","type","html","replaceAll","css","color","insertBefore","show","focus","not","removeClass","document","on","e","preventDefault","keypress","which","this","parents","submit","window","getSelection","getRangeAt","cloneContents","textContent","root","ranges","collapsed","rangeSelectors","map","range","describe","annotation","target","selectors","selector","anchor","createAnnotation","id","replace","startContainer","endContainer","startOffset","endOffset","start","end","ajax","url","data","getannotations","success","response","JSON","parse","Object","values","parseInt","recreateAnnotations","mouseenter","addClass","mouseleave","attr","complete","error"],"mappings":"gHAuBuB,IAAAA;;;;;;;kFAAvBC,SAAuBD,IAAvBC,UAAuBD,IAAAE,WAAAF,IAAAG,CAAAA,QAAAH,KA6PrBI,SAAAC,KA1PkBA,CAACC,KAAMC,iBAAkBC,SAAUC,gBAAiBC,UAEpE,IAAIC,QAAS,EACTC,YAAcC,QAEdC,eAAgB,EAuLpB,SAASC,eAAeC,cAEpB,GAAIL,QAAUK,cACV,EAAAC,yCACAC,aACAP,QAAS,OACN,GAAIJ,kBAAoBC,UAAYI,YAAYI,cAAcN,OAAQ,EACzE,EAAAO,yCACAC,aAEAP,OAASK,aAET,IAAIG,WAAaP,YAAYI,cAAcG,YAE3C,EAAAC,QAAAA,SAAE,mBAAqBJ,cAAcK,QAErC,EAAAD,iBAAE,oBAAsBD,WAAa,iCAAiCG,IAAIV,YAAYI,cAAcO,iBACpG,EAAAH,iBAAE,oBAAsBD,WAAa,+BAA+BG,IAAIV,YAAYI,cAAcQ,eAClG,EAAAJ,iBAAE,oBAAsBD,WAAa,8BAA8BG,IAAIV,YAAYI,cAAcS,cACjG,EAAAL,iBAAE,oBAAsBD,WAAa,4BAA4BG,IAAIV,YAAYI,cAAcU,YAC/F,EAAAN,iBAAE,oBAAsBD,WAAa,kCAAkCG,IAAIV,YAAYI,cAAcW,kBACrG,EAAAP,iBAAE,oBAAsBD,WAAa,gCAAgCG,IAAIV,YAAYI,cAAcY,gBACnG,EAAAR,iBAAE,oBAAsBD,WAAa,wBAAwBG,IAAIV,YAAYI,cAAca,QAC3F,EAAAT,iBAAE,oBAAsBD,WAAa,yBAAyBG,IAAIV,YAAYI,cAAcc,SAC5F,EAAAV,iBAAE,oBAAsBD,WAAa,yBAAyBG,IAAIV,YAAYI,cAAce,SAE5F,EAAAX,QAACjB,SAAC,oBAAsBgB,WAAa,+BAA+BG,IAAIN,eAExE,EAAAI,iBAAE,oBAAsBD,WAAa,0BAA0BG,IAAIV,YAAYI,cAAcgB,OAE7F,EAAAZ,iBAAE,oBAAsBD,WAAa,WAAWG,IAAIV,YAAYI,cAAciB,OAG9E,EAAAb,QAACjB,SAAC,2BAA6BgB,YAAYe,KACvCtB,YAAYI,cAAca,MAAMM,WAAW,IAAK,QAAQA,WAAW,IAAK,UAC5E,EAAAf,iBAAE,2BAA6BD,YAAYiB,IAAI,eAAgB,IAAMxB,YAAYI,cAAcqB,QAE/F,EAAAjB,QAACjB,SAAC,mBAAqBgB,WAAa,qBAAqBmB,aAAa,mBAAqBtB,eAC3F,EAAAI,QAAAA,SAAE,mBAAqBD,WAAa,qBAAqBoB,QACzD,EAAAnB,QAAAA,SAAE,mBAAqBD,WAAa,aAAaqB,OACrD,MACI,EAAApB,QAAAA,SAAE,mBAAqBJ,cAAcwB,OAE7C,CAKA,SAAStB,cACL,EAAAE,iBAAE,oBAAoBC,QAEtB,EAAAD,QAAAA,SAAE,gDAAgDE,IAAI,OAEtD,EAAAF,QAAAA,SAAE,kDAAkDE,KAAK,IACzD,EAAAF,QAAAA,SAAE,gDAAgDE,KAAK,IACvD,EAAAF,QAAAA,SAAE,+CAA+CE,KAAK,IACtD,EAAAF,QAAAA,SAAE,6CAA6CE,KAAK,IAEpD,EAAAF,QAAAA,SAAE,2CAA2CE,IAAI,KAEjD,EAAAF,QAAAA,SAAE,mBAAmBqB,IAAI,oBAAoBF,MACjD,EAjPA,EAAAnB,QAAAA,SAAE,iCAAiCsB,YAAY,aAC/C,EAAAtB,QAAAA,SAAE,iCAAiCsB,YAAY,aAC/C,EAAAtB,QAAAA,SAAE,mCAAmCsB,YAAY,eACjD,EAAAtB,QAAAA,SAAE,4BAA4BsB,YAAY,QAG1C,EAAAtB,QAACjB,SAACwC,UAAUC,GAAG,QAAS,iCAAiC,SAASC,GAC9DA,EAAEC,kBAEF,EAAA7B,yCAEAC,aAEAP,QAAS,CACb,KAGA,EAAAS,QAAAA,SAAE,+BAA+B2B,UAAS,SAASF,GAChC,IAAXA,EAAEG,SACF,EAAA5B,QAAAA,SAAE6B,MAAMC,QAAQ,UAAUC,SAC1BN,EAAEC,iBAEV,KAGA,EAAA1B,QAAAA,SAAEuB,UAAUC,GAAG,UAAW,iBAAiB,WAIvC,GAAkD,KAF9BQ,OAAOC,eAAeC,WAAW,GAEnCC,gBAAgBC,aAAsBjD,iBAAkB,EAEtE,EAAAU,yCAEAC,aAGAJ,cAuNZ,SAA0B2C,MAEtB,MAAMC,OAAS,CAACN,OAAOC,eAAeC,WAAW,IAEjD,GAAII,OAAOC,UACP,OAAO,KAGX,MAAMC,eAAiBF,OAAOG,KAAIC,QAAS,EAAAC,wBAASN,KAAMK,SAOpDE,WAAa,CACjBC,OANaL,eAAeC,KAAIK,YAAc,CAC9CC,SAAUD,eAUZ,OAFA,EAAAE,cAAMA,QAACJ,WAAYP,MAEZO,UACX,CA7O4BK,CAAiBpB,MAEjC,IAAI9B,WAAa8B,KAAKqB,GAAGC,QAAQ,cAAe,KAGhD,EAAAnD,QAAAA,SAAE,oBAAsBD,WAAa,iCAAiCG,IAClER,cAAcmD,OAAO,GAAGE,SAAS,GAAGK,iBACxC,EAAApD,QAAAA,SAAE,oBAAsBD,WAAa,+BAA+BG,IAChER,cAAcmD,OAAO,GAAGE,SAAS,GAAGM,eACxC,EAAArD,QAAAA,SAAE,oBAAsBD,WAAa,8BAA8BG,IAC/DR,cAAcmD,OAAO,GAAGE,SAAS,GAAGO,cACxC,EAAAtD,QAAAA,SAAE,oBAAsBD,WAAa,4BAA4BG,IAC7DR,cAAcmD,OAAO,GAAGE,SAAS,GAAGQ,YAGxC,EAAAvD,QAAAA,SAAE,oBAAsBD,WAAa,kCAAkCG,IACnER,cAAcmD,OAAO,GAAGE,SAAS,GAAGS,QACxC,EAAAxD,QAAAA,SAAE,oBAAsBD,WAAa,gCAAgCG,IACjER,cAAcmD,OAAO,GAAGE,SAAS,GAAGU,MAGxC,EAAAzD,QAAAA,SAAE,oBAAsBD,WAAa,wBAAwBG,IACzDR,cAAcmD,OAAO,GAAGE,SAAS,GAAGtC,QACxC,EAAAT,QAAAA,SAAE,oBAAsBD,WAAa,yBAAyBG,IAC1DR,cAAcmD,OAAO,GAAGE,SAAS,GAAGrC,SACxC,EAAAV,QAAAA,SAAE,oBAAsBD,WAAa,yBAAyBG,IAC1DR,cAAcmD,OAAO,GAAGE,SAAS,GAAGpC,SAExC,EAAAX,QAACjB,SAAC,oBAAsBgB,WAAa,WAAWG,IAAI,IAGpD,EAAAF,iBAAE,2BAA6BD,YAAYe,KACvCpB,cAAcmD,OAAO,GAAGE,SAAS,GAAGtC,MAAMM,WAAW,IAAK,QAAQA,WAAW,IAAK,UAEtF,EAAAf,QAAAA,SAAE,mBAAqBD,WAAa,qBAAqBoB,QACzD,EAAAnB,QAAAA,SAAE,oBAAsBD,WAAa,aAAaqB,OACtD,CACJ,IAGApB,QAACjB,QAAC2E,KAAK,CACHC,IAAK,oBACLC,KAAM,CAACV,GAAMhE,KAAM2E,eAAkB,EAAGvE,OAAUA,QAClDwE,QAAS,SAASC,UACdvE,YAAcwE,KAAKC,MAAMF,UAqEjC,WAEI,IAAK,IAAInB,cAAcsB,OAAOC,OAAO3E,aAAc,CAE/C,MAaME,cAAgB,CAClBkD,WAAYA,WACZC,OAfmB,CAAC,CACpB,CAAChC,KAAM,gBAAiBuC,eAAgBR,WAAWzC,eAAgBmD,YAAac,SAASxB,WAAWvC,aACpGgD,aAAcT,WAAWxC,aAAcmD,UAAWa,SAASxB,WAAWtC,YACtE,CAACO,KAAM,uBAAwB2C,MAAOY,SAASxB,WAAWrC,iBAC1DkD,IAAKW,SAASxB,WAAWpC,gBACzB,CAACK,KAAM,oBAAqBJ,MAAOmC,WAAWnC,MAAOC,OAAQkC,WAAWlC,OAAQC,OAAQiC,WAAWjC,UAGzE8B,KAAIK,YAAc,CAC5CC,SAAUD,gBASd,EAAAE,sBAAOtD,eAAe,EAAAM,iBAAE,eAAiB4C,WAAW7C,YAAY,GACpE,CACJ,CA3FQsE,IAGA,EAAArE,iBAAE,cAAcsE,YAAW,WACvB,IAAIpB,GAAKrB,KAAKqB,GAAGC,QAAQ,aAAc,KACvC,EAAAnD,QAAAA,SAAE,mBAAqBkD,IAAIqB,SAAS,YACpC,EAAAvE,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,mBAAoB,YAClD,KAEA,EAAAhB,iBAAE,cAAcwE,YAAW,WACvB,IAAItB,GAAKrB,KAAKqB,GAAGC,QAAQ,aAAc,KACvC,EAAAnD,QAAAA,SAAE,mBAAqBkD,IAAI5B,YAAY,YACvC,EAAAtB,QAAAA,SAAE,cAAgBkD,IAAIlC,IAAI,oBAAoB,EAAAhB,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,uBAC5E,KAGA,EAAAhB,QAAAA,SAAEuB,UAAUC,GAAG,YAAa,mBAAmB,YAC3C,EAAAxB,QAAAA,SAAE,mBAAmBuE,SAAS,UAClC,KAEA,EAAAvE,QAAAA,SAAEuB,UAAUC,GAAG,aAAc,mBAAmB,YAC5C,EAAAxB,QAAAA,SAAE,mBAAmBsB,YAAY,UACrC,KAGA,EAAAtB,QAAAA,SAAEuB,UAAUC,GAAG,QAAS,cAAc,WAElC7B,eADSkC,KAAKqB,GAAGC,QAAQ,aAAc,IAE3C,KAGA,EAAAnD,QAAAA,SAAEuB,UAAUC,GAAG,QAAS,oBAAoB,WAExC7B,eADSkC,KAAKqB,GAAGC,QAAQ,mBAAoB,IAEjD,KAGA,EAAAnD,QAAAA,SAAEuB,UAAUC,GAAG,YAAa,oBAAoB,WAC5C,IAAI0B,GAAKrB,KAAKqB,GAAGC,QAAQ,mBAAoB,KAC7C,EAAAnD,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,mBAAoB,YAClD,KAEA,EAAAhB,QAAAA,SAAEuB,UAAUC,GAAG,aAAc,oBAAoB,WAC7C,IAAI0B,GAAKrB,KAAKqB,GAAGC,QAAQ,mBAAoB,KAC7C,EAAAnD,QAAAA,SAAE,cAAgBkD,IAAIlC,IAAI,oBAAoB,EAAAhB,QAACjB,SAAC,cAAgBmE,IAAIlC,IAAI,uBAC5E,IAIuB,GAAnB3B,mBACA,EAAAW,QAACjB,SAAC,cAAgBM,iBAAiBoF,KAAK,YAAa,IACrD,EAAAzE,QAAAA,SAAE,cAAgBX,iBAAiB+B,QAG1C,EACDsD,SAAU,YACN,EAAA1E,iBAAE,YAAYC,MACjB,EACD0E,MAAO,WAEP,GAmGJ,CAgCH"}